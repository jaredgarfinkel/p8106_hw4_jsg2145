p8106\_hw4\_jsg2145
================
Jared Garfinkel
4/25/2020

``` r
library(lasso2)
```

    ## R Package to solve regression problems while imposing
    ##   an L1 constraint on the parameters. Based on S-plus Release 2.1
    ## Copyright (C) 1998, 1999
    ## Justin Lokhorst   <jlokhors@stats.adelaide.edu.au>
    ## Berwin A. Turlach <bturlach@stats.adelaide.edu.au>
    ## Bill Venables     <wvenable@stats.adelaide.edu.au>
    ## 
    ## Copyright (C) 2002
    ## Martin Maechler <maechler@stat.math.ethz.ch>

``` r
data(Prostate)

x <- model.matrix(lpsa~.,Prostate)[,-1]
y <- Prostate$lpsa
```

``` r
cp_grid = expand.grid(.001, 1, .0001)

tree1 <- rpart(lpsa~., Prostate, control = rpart.control(cp = cp_grid))
rpart.plot(tree1)
```

<img src="p8106_hw4_jsg2145_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />

``` r
str(tree1)
```

    ## List of 14
    ##  $ frame              :'data.frame': 7 obs. of  8 variables:
    ##   ..$ var       : Factor w/ 2 levels "<leaf>","lcavol": 2 2 1 1 2 1 1
    ##   ..$ n         : int [1:7] 97 76 9 67 21 10 11
    ##   ..$ wt        : num [1:7] 97 76 9 67 21 10 11
    ##   ..$ dev       : num [1:7] 127.9 67.3 5.6 38 16.2 ...
    ##   ..$ yval      : num [1:7] 2.478 2.123 0.602 2.327 3.765 ...
    ##   ..$ complexity: num [1:7] 0.3471 0.1846 0.001 0.001 0.0346 ...
    ##   ..$ ncompete  : int [1:7] 1 1 0 0 1 0 0
    ##   ..$ nsurrogate: int [1:7] 0 0 0 0 0 0 0
    ##  $ where              : Named int [1:97] 3 3 3 3 4 3 4 4 3 4 ...
    ##   ..- attr(*, "names")= chr [1:97] "1" "2" "3" "4" ...
    ##  $ call               : language rpart(formula = lpsa ~ ., data = Prostate, control = rpart.control(cp = cp_grid))
    ##  $ terms              :Classes 'terms', 'formula'  language lpsa ~ lcavol + lweight + age + lbph + svi + lcp + gleason + pgg45
    ##   .. ..- attr(*, "variables")= language list(lpsa, lcavol, lweight, age, lbph, svi, lcp, gleason, pgg45)
    ##   .. ..- attr(*, "factors")= int [1:9, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
    ##   .. .. ..- attr(*, "dimnames")=List of 2
    ##   .. .. .. ..$ : chr [1:9] "lpsa" "lcavol" "lweight" "age" ...
    ##   .. .. .. ..$ : chr [1:8] "lcavol" "lweight" "age" "lbph" ...
    ##   .. ..- attr(*, "term.labels")= chr [1:8] "lcavol" "lweight" "age" "lbph" ...
    ##   .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
    ##   .. ..- attr(*, "intercept")= int 1
    ##   .. ..- attr(*, "response")= int 1
    ##   .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
    ##   .. ..- attr(*, "predvars")= language list(lpsa, lcavol, lweight, age, lbph, svi, lcp, gleason, pgg45)
    ##   .. ..- attr(*, "dataClasses")= Named chr [1:9] "numeric" "numeric" "numeric" "numeric" ...
    ##   .. .. ..- attr(*, "names")= chr [1:9] "lpsa" "lcavol" "lweight" "age" ...
    ##  $ cptable            : num [1:4, 1:5] 0.3471 0.1846 0.0346 0.001 0 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:4] "1" "2" "3" "4"
    ##   .. ..$ : chr [1:5] "CP" "nsplit" "rel error" "xerror" ...
    ##  $ method             : chr "anova"
    ##  $ parms              : NULL
    ##  $ control            :List of 9
    ##   ..$ minsplit      : int 20
    ##   ..$ minbucket     : num 7
    ##   ..$ cp            :'data.frame':   1 obs. of  3 variables:
    ##   .. ..$ Var1: num 0.001
    ##   .. ..$ Var2: num 1
    ##   .. ..$ Var3: num 1e-04
    ##   .. ..- attr(*, "out.attrs")=List of 2
    ##   .. .. ..$ dim     : int [1:3] 1 1 1
    ##   .. .. ..$ dimnames:List of 3
    ##   .. .. .. ..$ Var1: chr "Var1=0.001"
    ##   .. .. .. ..$ Var2: chr "Var2=1"
    ##   .. .. .. ..$ Var3: chr "Var3=1e-04"
    ##   ..$ maxcompete    : int 4
    ##   ..$ maxsurrogate  : int 5
    ##   ..$ usesurrogate  : int 2
    ##   ..$ surrogatestyle: int 0
    ##   ..$ maxdepth      : int 30
    ##   ..$ xval          : int 10
    ##  $ functions          :List of 2
    ##   ..$ summary:function (yval, dev, wt, ylevel, digits)  
    ##   ..$ text   :function (yval, dev, wt, ylevel, digits, n, use.n)  
    ##  $ numresp            : int 1
    ##  $ splits             : num [1:6, 1:5] 97 97 76 76 21 21 -1 -1 -1 -1 ...
    ##   ..- attr(*, "dimnames")=List of 2
    ##   .. ..$ : chr [1:6] "lcavol" "svi" "lcavol" "lweight" ...
    ##   .. ..$ : chr [1:5] "count" "ncat" "improve" "index" ...
    ##  $ variable.importance: Named num 72.4
    ##   ..- attr(*, "names")= chr "lcavol"
    ##  $ y                  : Named num [1:97] -0.431 -0.163 -0.163 -0.163 0.372 ...
    ##   ..- attr(*, "names")= chr [1:97] "1" "2" "3" "4" ...
    ##  $ ordered            : Named logi [1:8] FALSE FALSE FALSE FALSE FALSE FALSE ...
    ##   ..- attr(*, "names")= chr [1:8] "lcavol" "lweight" "age" "lbph" ...
    ##  - attr(*, "xlevels")= Named list()
    ##  - attr(*, "class")= chr "rpart"

``` r
ctrl1 = trainControl(method = "repeatedcv", number = 10, repeats = 5)
tree_caret = train(x, y, method = "rpart",
                   tuneGrid = data.frame(cp = seq(.001, 1, length = 1000)),
                   trControl = ctrl1)

tree_caret$bestTune
```

    ##      cp
    ## 7 0.007

``` r
ggplot(tree_caret, highlight = TRUE)
```

<img src="p8106_hw4_jsg2145_files/figure-gfm/rpart in caret-1.png" width="90%" />

``` r
tree_caret$finalModel$cptable
```

    ##           CP nsplit rel error
    ## 1 0.34710828      0 1.0000000
    ## 2 0.18464743      1 0.6528917
    ## 3 0.05931585      2 0.4682443
    ## 4 0.03475635      3 0.4089284
    ## 5 0.03460901      4 0.3741721
    ## 6 0.02156368      5 0.3395631
    ## 7 0.02146995      6 0.3179994
    ## 8 0.00000000      7 0.2965295

``` r
rpart.plot(tree_caret$finalModel)
```

<img src="p8106_hw4_jsg2145_files/figure-gfm/rpart in caret-2.png" width="90%" />
